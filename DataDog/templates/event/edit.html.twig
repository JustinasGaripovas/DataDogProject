{% extends 'base.html.twig' %}

{% block title %} KTU NOW | Editing event{% endblock %}

{% block head %}
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css"/>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <style>
        #map {
            height: 400px;
            width: 100%;
        }
        .center-image {
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 80%;
        }
    </style>
{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function () {

            var my_lat = {{ event.lat }};
            var my_lon = {{ event.lng }};

            // initialize the map
            var mymap = L.map('map').setView([my_lat, my_lon], 13);
            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGFpc2FkbWluIiwiYSI6ImNqcjk3ZWh0djAxemo0NW15Zm9pb3BiNHAifQ.UM9_gDRuLxs1mGvPSjSsHQ', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                maxZoom: 18,
                minZoom: 12,
                id: 'mapbox.streets',
                accessToken: 'your.mapbox.access.token'
            }).addTo(mymap);


            //  Tikram map, kur bus visi renginiai, cia bus for-iukas
            var marker = L.marker([my_lat, my_lon]).addTo(mymap);

            mymap.on('click', function(e) {

                mymap.removeLayer(marker);

                marker = new L.marker([e.latlng['lat'], e.latlng['lng']]).addTo(mymap);


                $('#event_lat').val(e.latlng['lat']);
                $('#event_lng').val(e.latlng['lng']);

                console.log(e.latlng); // e is an event object (MouseEvent in this case)
            });
        });
    </script>
{% endblock %}

{% block body %}


    {{ form_start(form) }}

    <div class="jumbotron">

    {{ form_errors(form) }}
    {% for child in form if not child.rendered %}
        <div class="form-group row">
            {{ form_label(child, null, { 'label_attr': {'class': 'col-sm-2 col-form-label' } }) }}
            <div class="col-sm-10">
                {{ form_widget(child,{ 'attr': {'class': 'form-control' } }) }}
            </div>
        </div>
    {% endfor %}



    <button type="submit" class="btn btn-primary">Submit</button>
    </div>
    {{ form_end(form) }}

    <br>

    <div class="my-1 py-1 " id="map"></div>

    <br>

{% endblock %}
